import{g as d,d as i,e as p,u as P,Z as I,w as c,f as t,t as o,j as a,F as D,h as V,i as u,n as j,q as E}from"./app-BYhsu56_.js";import{_ as N}from"./AuthenticatedLayout-B6T8qzH8.js";import"./HelpLink-0Gkg05qS.js";const A={class:"flex items-center justify-between"},T={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3"},z={class:"py-12"},L={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},B={class:"bg-white shadow-lg rounded-lg overflow-hidden",id:"invoice-content"},$={class:"bg-gradient-to-r from-amber-600 to-amber-700 text-white py-6 px-8"},q={class:"flex justify-between items-start"},M={class:"text-right"},Y={class:"text-amber-100 text-sm mt-2"},H={class:"p-8"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"},U={class:"space-y-2 text-gray-600"},G={class:"space-y-2 text-gray-600"},R={class:"mb-8"},W={class:"overflow-x-auto"},_={class:"min-w-full divide-y divide-gray-200"},Z={class:"bg-white divide-y divide-gray-200"},J={class:"px-6 py-4 whitespace-nowrap"},K={class:"flex items-center"},Q={class:"text-sm font-medium text-gray-900"},X={key:0,class:"text-sm text-gray-500"},tt={key:0},et={key:1},st={key:2},ot={key:1,class:"text-xs text-gray-500 mt-1"},nt={key:0},rt={key:1},at={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},dt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},it={class:"px-6 py-4 whitespace-nowrap text-sm text-blue-600"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium"},ut={class:"border-t border-gray-200 pt-6"},mt={class:"flex justify-end"},pt={class:"w-64"},ct={class:"flex justify-between text-gray-600 mb-2"},gt={class:"flex justify-between text-gray-600 mb-2"},xt={class:"text-blue-600"},ft={class:"border-t border-gray-200 pt-2"},yt={class:"flex justify-between text-lg font-bold text-gray-900"},bt={class:"text-amber-600"},vt={class:"mt-8 grid grid-cols-1 md:grid-cols-2 gap-8"},wt={class:"space-y-2 text-gray-600"},ht={key:0},Pt={class:"space-y-2 text-gray-600"},Dt={class:"mt-12 pt-8 border-t border-gray-200"},kt={class:"text-center text-gray-500 text-sm"},St={class:"mt-2 text-xs"},Vt={__name:"Invoice",props:{order:{type:Object,required:!0}},setup(r){const g=r,m=s=>Math.round(s/1.1),x=s=>s-m(s),k=s=>!s||!s.order_items?0:s.order_items.reduce((e,l)=>e+m(l.price||0)*(l.quantity||1),0),S=s=>!s||!s.order_items?0:s.order_items.reduce((e,l)=>e+x(l.price||0)*(l.quantity||1),0),F=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"paid":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},C=s=>{switch(s){case"pending":return"Pendiente";case"paid":return"Pagado";case"cancelled":return"Cancelado";default:return s}},f=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),y=async()=>{try{console.log("🎯 Iniciando descarga de PDF para pedido:",g.order.id);const s=document.createElement("div");s.innerHTML=`
      <div style="
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 15px 25px;
        border-radius: 8px;
        z-index: 9999;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      ">
        <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
        <span>Generando PDF, por favor espere...</span>
      </div>
    `,document.body.appendChild(s);const e=document.createElement("iframe");e.style.display="none",document.body.appendChild(e),e.src=`/orders/${g.order.id}/download-invoice`,setTimeout(()=>{document.body.contains(s)&&document.body.removeChild(s),document.body.contains(e)&&document.body.removeChild(e)},1e4)}catch(s){console.error("Error al generar el PDF:",s),alert("Ocurrió un error al generar el PDF. Por favor, inténtalo de nuevo.");const e=document.querySelector('[style*="Generando PDF"]');e&&document.body.removeChild(e.parentElement)}};return(s,e)=>(i(),d(D,null,[p(P(I),{title:"Factura"}),p(N,null,{header:c(()=>[t("div",A,[e[2]||(e[2]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Factura del Pedido",-1)),t("div",T,[p(P(E),{href:s.route("orders.index"),class:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 text-center"},{default:c(()=>[...e[0]||(e[0]=[a("← Volver a Pedidos",-1)])]),_:1},8,["href"]),t("button",{onClick:y,class:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2 min-w-[140px] shadow-lg hover:shadow-xl transform hover:scale-105"},[...e[1]||(e[1]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("span",null,"📄 Descargar PDF",-1)])])])])]),default:c(()=>{var l,b,v,w,h;return[t("div",z,[t("div",L,[t("div",B,[t("div",$,[t("div",q,[e[4]||(e[4]=t("div",null,[t("h1",{class:"text-2xl font-bold mb-1"},"☕ Daylen Cafetería"),t("p",{class:"text-amber-100"},"Sistema de Facturación"),t("p",{class:"text-amber-100 text-sm mt-1"},"Factura Electrónica")],-1)),t("div",M,[e[3]||(e[3]=t("div",{class:"bg-white text-amber-800 px-3 py-1 rounded-lg font-bold text-lg"},"FACTURA",-1)),t("p",Y,"N° "+o(r.order.id.toString().padStart(6,"0")),1)])])]),t("div",H,[t("div",O,[t("div",null,[e[10]||(e[10]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Información de la Empresa",-1)),t("div",U,[t("p",null,[e[5]||(e[5]=t("span",{class:"font-medium"},"Empresa:",-1)),a(" "+o(((l=s.$page.props.shopSettings)==null?void 0:l.shop_name)||"Daylen Cafetería"),1)]),t("p",null,[e[6]||(e[6]=t("span",{class:"font-medium"},"Dirección:",-1)),a(" "+o(((b=s.$page.props.shopSettings)==null?void 0:b.address)||"Calle Carlos Gómez, Barrio Remansito Sector 5, Ciudad del Este"),1)]),t("p",null,[e[7]||(e[7]=t("span",{class:"font-medium"},"Teléfono:",-1)),a(" "+o(((v=s.$page.props.shopSettings)==null?void 0:v.phone)||"+595 986 195914"),1)]),t("p",null,[e[8]||(e[8]=t("span",{class:"font-medium"},"Email:",-1)),a(" "+o(((w=s.$page.props.shopSettings)==null?void 0:w.email)||"daylencoffee@gmail.com"),1)]),t("p",null,[e[9]||(e[9]=t("span",{class:"font-medium"},"RUC:",-1)),a(" "+o(((h=s.$page.props.shopSettings)==null?void 0:h.ruc)||"12345678-9"),1)])])]),t("div",null,[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Información del Cliente",-1)),t("div",G,[t("p",null,[e[11]||(e[11]=t("span",{class:"font-medium"},"Cliente:",-1)),a(" "+o(r.order.user.name),1)]),t("p",null,[e[12]||(e[12]=t("span",{class:"font-medium"},"Email:",-1)),a(" "+o(r.order.user.email),1)]),t("p",null,[e[13]||(e[13]=t("span",{class:"font-medium"},"Nombre de Entrega:",-1)),a(" "+o(r.order.customer_name),1)]),t("p",null,[e[14]||(e[14]=t("span",{class:"font-medium"},"Teléfono:",-1)),a(" "+o(r.order.phone),1)]),t("p",null,[e[15]||(e[15]=t("span",{class:"font-medium"},"Dirección:",-1)),a(" "+o(r.order.address),1)])])])]),t("div",R,[e[20]||(e[20]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Detalles del Pedido",-1)),t("div",W,[t("table",_,[e[19]||(e[19]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Producto"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cantidad"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Precio Unit. (sin IVA)"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"IVA Incluido"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subtotal")])],-1)),t("tbody",Z,[(i(!0),d(D,null,V(r.order.order_items,n=>(i(),d("tr",{key:n.id},[t("td",J,[t("div",K,[t("div",null,[t("div",Q,o(n.product.name),1),n.size||n.sugar?(i(),d("div",X,[n.size?(i(),d("span",tt,"Tamaño: "+o(n.size),1)):u("",!0),n.size&&n.sugar?(i(),d("span",et," • ")):u("",!0),n.sugar?(i(),d("span",st,"Azúcar: "+o(n.sugar),1)):u("",!0)])):u("",!0),n.toppings&&n.toppings.length>0||n.addons&&n.addons.length>0?(i(),d("div",ot,[n.toppings&&n.toppings.length>0?(i(),d("div",nt,[e[17]||(e[17]=t("span",{class:"font-medium"},"Coberturas:",-1)),a(" "+o(n.toppings.join(", ")),1)])):u("",!0),n.addons&&n.addons.length>0?(i(),d("div",rt,[e[18]||(e[18]=t("span",{class:"font-medium"},"Agregados:",-1)),a(" "+o(n.addons.join(", ")),1)])):u("",!0)])):u("",!0)])])]),t("td",at,o(n.quantity),1),t("td",dt,"₲ "+o(Number(m(n.price)).toLocaleString("es-PY",{maximumFractionDigits:0})),1),t("td",it,"₲ "+o(Number(x(n.price)).toLocaleString("es-PY",{maximumFractionDigits:0})),1),t("td",lt,"₲ "+o(Number(n.subtotal).toLocaleString("es-PY",{maximumFractionDigits:0})),1)]))),128))])])])]),t("div",ut,[t("div",mt,[t("div",pt,[t("div",ct,[e[21]||(e[21]=t("span",null,"Subtotal (sin IVA):",-1)),t("span",null,"₲ "+o(Number(k(r.order)).toLocaleString("es-PY",{maximumFractionDigits:0})),1)]),t("div",gt,[e[22]||(e[22]=t("span",null,"IVA (10% incluido):",-1)),t("span",xt,"₲ "+o(Number(S(r.order)).toLocaleString("es-PY",{maximumFractionDigits:0})),1)]),e[24]||(e[24]=t("div",{class:"flex justify-between text-gray-600 mb-2"},[t("span",null,"Descuento:"),t("span",null,"₲ 0")],-1)),t("div",ft,[t("div",yt,[e[23]||(e[23]=t("span",null,"TOTAL (IVA incluido):",-1)),t("span",bt,"₲ "+o(Number(r.order.total).toLocaleString("es-PY",{maximumFractionDigits:0})),1)])])])])]),t("div",vt,[t("div",null,[e[28]||(e[28]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Información de Pago",-1)),t("div",wt,[t("p",null,[e[25]||(e[25]=t("span",{class:"font-medium"},"Método de Pago:",-1)),a(" "+o(r.order.payment_method==="efectivo"?"Efectivo":"Tarjeta"),1)]),t("p",null,[e[26]||(e[26]=t("span",{class:"font-medium"},"Estado:",-1)),t("span",{class:j([F(r.order.status),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ml-2"])},o(C(r.order.status)),3)]),r.order.payment_id?(i(),d("p",ht,[e[27]||(e[27]=t("span",{class:"font-medium"},"ID de Pago:",-1)),a(" "+o(r.order.payment_id),1)])):u("",!0)])]),t("div",null,[e[31]||(e[31]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Información del Pedido",-1)),t("div",Pt,[t("p",null,[e[29]||(e[29]=t("span",{class:"font-medium"},"Fecha del Pedido:",-1)),a(" "+o(f(r.order.created_at)),1)]),t("p",null,[e[30]||(e[30]=t("span",{class:"font-medium"},"Notas:",-1)),a(" "+o(r.order.notes||"Sin notas"),1)])])])]),t("div",Dt,[t("div",kt,[e[32]||(e[32]=t("p",null,"¡Gracias por su compra!",-1)),e[33]||(e[33]=t("p",{class:"mt-1"},"Para consultas, contáctenos en daylencoffee@gmail.com",-1)),t("p",St,"Factura generada automáticamente el "+o(f(new Date)),1)])]),t("div",{class:"mt-8 pt-6 border-t border-gray-200"},[t("div",{class:"bg-gradient-to-r from-red-50 to-red-100 border border-red-200 rounded-lg p-6 text-center"},[e[35]||(e[35]=t("h3",{class:"text-lg font-semibold text-red-800 mb-3"},"¿Necesitas tu factura en PDF?",-1)),e[36]||(e[36]=t("p",{class:"text-red-600 mb-4"},"Haz clic en el botón a continuación para descargar tu factura en formato PDF",-1)),t("button",{onClick:y,class:"bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2 mx-auto min-w-[200px] text-lg"},[...e[34]||(e[34]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("span",null,"Descargar Factura PDF",-1)])])])])])])])])]}),_:1})],64))}};export{Vt as default};
